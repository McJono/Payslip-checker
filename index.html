<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Payslip Checker - Calculate Your Pay</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Payslip Checker</h1>
            <p>Calculate your pay with tax and HELP debt deductions</p>
        </header>

        <nav class="tabs">
            <button class="tab-button active" data-tab="calculator">Pay Calculator</button>
            <button class="tab-button" data-tab="hours">Hours Calculator</button>
            <button class="tab-button" data-tab="admin">Admin Settings</button>
        </nav>

        <!-- Pay Calculator Tab -->
        <div id="calculator" class="tab-content active">
            <div class="card">
                <h2 style="display: flex; justify-content: space-between; align-items: center;">
                    <span>Calculate Your Pay</span>
                    <button onclick="clearLocalStorage('calculator')" class="btn btn-danger" style="font-size: 0.8em; padding: 8px 15px;">Clear Calculator Data</button>
                </h2>
                
                <div class="form-group">
                    <label for="award">Select Award:</label>
                    <select id="award" class="form-control">
                        <option value="">-- Select Award --</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="baseRate">Base Pay Rate ($/hour):</label>
                    <input type="number" id="baseRate" class="form-control" step="0.01" min="0" placeholder="25.00">
                </div>

                <div class="form-group">
                    <label for="payPeriod">Pay Period:</label>
                    <select id="payPeriod" class="form-control">
                        <option value="weekly">Weekly</option>
                        <option value="fortnightly">Fortnightly</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Hours Worked:</label>
                    <div class="hours-grid">
                        <div class="hour-input">
                            <label for="normalHours">Normal Hours:</label>
                            <input type="number" id="normalHours" class="form-control" step="0.25" min="0" value="0" placeholder="38">
                        </div>
                        <div class="hour-input">
                            <label for="overtimeHours">Overtime Hours:</label>
                            <input type="number" id="overtimeHours" class="form-control" step="0.25" min="0" value="0" placeholder="5">
                        </div>
                        <div class="hour-input">
                            <label for="saturdayHours">Saturday Hours:</label>
                            <input type="number" id="saturdayHours" class="form-control" step="0.25" min="0" value="0" placeholder="8">
                        </div>
                        <div class="hour-input">
                            <label for="sundayHours">Sunday Hours:</label>
                            <input type="number" id="sundayHours" class="form-control" step="0.25" min="0" value="0" placeholder="8">
                        </div>
                        <div class="hour-input">
                            <label for="afternoonHours">Afternoon Shift Hours:</label>
                            <input type="number" id="afternoonHours" class="form-control" step="0.25" min="0" value="0" placeholder="0">
                        </div>
                        <div class="hour-input">
                            <label for="nightShiftHours">Night Shift Hours:</label>
                            <input type="number" id="nightShiftHours" class="form-control" step="0.25" min="0" value="0" placeholder="0">
                        </div>
                    </div>
                </div>

                <div class="form-group" id="allowancesQuestionsSection">
                    <label>Allowances:</label>
                    <div id="allowancesQuestions"></div>
                    <div>
                        <label for="manualAllowances">Additional Allowances ($):</label>
                        <input type="number" id="manualAllowances" class="form-control" step="0.01" min="0" value="0" placeholder="0.00">
                        <small class="info-text">Enter any additional allowances not listed above</small>
                    </div>
                </div>

                <div class="form-group">
                    <label for="helpDebt">Do you have a HELP Debt?</label>
                    <select id="helpDebt" class="form-control">
                        <option value="false">No</option>
                        <option value="true">Yes</option>
                    </select>
                </div>

                <button onclick="calculatePay()" class="btn btn-primary">Calculate Pay</button>

                <div id="results" class="results" style="display: none;">
                    <h3>Pay Breakdown (<span id="payPeriodLabel">Weekly</span>)</h3>
                    <div class="result-item">
                        <span>Gross Pay:</span>
                        <span id="grossPay">$0.00</span>
                    </div>
                    <div class="result-item breakdown">
                        <span>- Normal Hours Pay:</span>
                        <span id="normalPay">$0.00</span>
                    </div>
                    <div class="result-item breakdown">
                        <span>- Overtime Pay:</span>
                        <span id="overtimePay">$0.00</span>
                    </div>
                    <div class="result-item breakdown">
                        <span>- Saturday Pay:</span>
                        <span id="saturdayPay">$0.00</span>
                    </div>
                    <div class="result-item breakdown">
                        <span>- Sunday Pay:</span>
                        <span id="sundayPay">$0.00</span>
                    </div>
                    <div class="result-item breakdown">
                        <span>- Afternoon Shift Pay:</span>
                        <span id="afternoonPay">$0.00</span>
                    </div>
                    <div class="result-item breakdown">
                        <span>- Night Shift Pay:</span>
                        <span id="nightShiftPay">$0.00</span>
                    </div>
                    <div class="result-item breakdown">
                        <span>- Allowances:</span>
                        <span id="allowancesPay">$0.00</span>
                    </div>
                    <div class="result-item">
                        <span>Tax Withheld:</span>
                        <span id="tax">$0.00</span>
                    </div>
                    <div class="result-item">
                        <span>HELP Debt Repayment:</span>
                        <span id="helpRepayment">$0.00</span>
                    </div>
                    <div class="result-item net-pay">
                        <span><strong>Net Pay:</strong></span>
                        <span id="netPay"><strong>$0.00</strong></span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Hours Calculator Tab -->
        <div id="hours" class="tab-content">
            <div class="card">
                <h2 style="display: flex; justify-content: space-between; align-items: center;">
                    <span>Calculate Hours Worked</span>
                    <button onclick="clearLocalStorage('shifts')" class="btn btn-danger" style="font-size: 0.8em; padding: 8px 15px;">Clear Shift Data</button>
                </h2>
                
                <div class="form-group">
                    <label for="hoursAward">Select Award:</label>
                    <select id="hoursAward" class="form-control">
                        <option value="">-- Select Award --</option>
                    </select>
                </div>

                <div id="shiftsContainer">
                    <div class="shift-entry" data-shift-index="0">
                        <h3>Shift 1</h3>
                        
                        <div class="form-group">
                            <label for="shiftStartDate-0">Shift Start Date:</label>
                            <input type="date" id="shiftStartDate-0" class="form-control shift-start-date">
                        </div>

                        <div class="form-group">
                            <label for="shiftStartTime-0">Shift Start Time:</label>
                            <input type="time" id="shiftStartTime-0" class="form-control shift-start-time">
                        </div>

                        <div class="form-group">
                            <label for="isSleepover-0">Is this a sleepover shift?</label>
                            <select id="isSleepover-0" class="form-control shift-sleepover">
                                <option value="false">No</option>
                                <option value="true">Yes</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="shiftEndDate-0">Shift End Date:</label>
                            <input type="date" id="shiftEndDate-0" class="form-control shift-end-date">
                        </div>

                        <div class="form-group">
                            <label for="shiftEndTime-0">Shift End Time:</label>
                            <input type="time" id="shiftEndTime-0" class="form-control shift-end-time">
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <button onclick="addShift()" class="btn btn-secondary">Add Another Shift</button>
                </div>

                <button onclick="calculateHours()" class="btn btn-primary">Calculate Hours</button>

                <div id="hoursResults" class="results" style="display: none;">
                    <h3>Hours Breakdown</h3>
                    <div class="result-item">
                        <span>Total Hours Worked:</span>
                        <span id="totalHours">0.00</span>
                    </div>
                    <div class="result-item breakdown">
                        <span>- Normal Hours:</span>
                        <span id="calculatedNormalHours">0.00</span>
                    </div>
                    <div class="result-item breakdown">
                        <span>- Overtime Hours:</span>
                        <span id="calculatedOvertimeHours">0.00</span>
                    </div>
                    <div class="result-item breakdown">
                        <span>- Saturday Hours:</span>
                        <span id="calculatedSaturdayHours">0.00</span>
                    </div>
                    <div class="result-item breakdown">
                        <span>- Sunday Hours:</span>
                        <span id="calculatedSundayHours">0.00</span>
                    </div>
                    <div class="result-item breakdown">
                        <span>- Afternoon Shift Hours:</span>
                        <span id="calculatedAfternoonHours">0.00</span>
                    </div>
                    <div class="result-item breakdown">
                        <span>- Night Shift Hours:</span>
                        <span id="calculatedNightShiftHours">0.00</span>
                    </div>
                    <div id="overtimeWarnings" class="overtime-warnings"></div>
                </div>
            </div>
        </div>

        <!-- Admin Settings Tab -->
        <div id="admin" class="tab-content">
            <div class="card">
                <h2 style="display: flex; justify-content: space-between; align-items: center;">
                    <span>Award Management</span>
                    <button onclick="clearLocalStorage('awards')" class="btn btn-danger" style="font-size: 0.8em; padding: 8px 15px;">Clear Awards Data</button>
                </h2>
                
                <div class="form-group">
                    <label for="awardName">Award Name:</label>
                    <input type="text" id="awardName" class="form-control" placeholder="e.g., Retail Award">
                </div>

                <div class="form-group">
                    <label class="tooltip-label">Rate Multipliers:
                        <span class="tooltip-text">Define pay rate multipliers for different work conditions. Normal rate is 1.0 (base pay). Other rates are multiplied by the base hourly rate.</span>
                    </label>
                    <div class="rate-grid">
                        <div>
                            <label for="normalRate">Normal Rate:</label>
                            <input type="number" id="normalRate" class="form-control" step="0.01" min="0" value="1.0">
                        </div>
                        <div>
                            <label for="saturdayRate">Saturday Rate (x):</label>
                            <input type="number" id="saturdayRate" class="form-control" step="0.01" min="0" value="1.5">
                        </div>
                        <div>
                            <label for="sundayRate">Sunday Rate (x):</label>
                            <input type="number" id="sundayRate" class="form-control" step="0.01" min="0" value="2.0">
                        </div>
                        <div>
                            <label for="nightShiftRate">Night Shift Rate (x):</label>
                            <input type="number" id="nightShiftRate" class="form-control" step="0.01" min="0" value="1.25">
                        </div>
                        <div>
                            <label for="afternoonShiftRate">Afternoon Shift Rate (x):</label>
                            <input type="number" id="afternoonShiftRate" class="form-control" step="0.01" min="0" value="1.15">
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label class="tooltip-label">Overtime Rules:
                        <span class="tooltip-text">Configure when overtime rates apply and shift constraints. Set thresholds for when different overtime multipliers kick in based on hours worked.</span>
                    </label>
                    <div class="rate-grid">
                        <div>
                            <label for="maxDailyHours">Max Daily Hours (before overtime):</label>
                            <input type="number" id="maxDailyHours" class="form-control" step="0.25" min="0" value="8" placeholder="8">
                        </div>
                        <div>
                            <label for="overtimeRate">Overtime Rate 1 (x):</label>
                            <input type="number" id="overtimeRate" class="form-control" step="0.01" min="0" value="1.5">
                        </div>
                        <div>
                            <label for="overtime2Hours">After how many hours (Overtime 2):</label>
                            <input type="number" id="overtime2Hours" class="form-control" step="0.25" min="0" value="10" placeholder="10">
                        </div>
                        <div>
                            <label for="overtime2Rate">Overtime Rate 2 (x):</label>
                            <input type="number" id="overtime2Rate" class="form-control" step="0.01" min="0" value="2.0">
                        </div>
                        <div>
                            <label for="minBreakHours">Min Break Between Shifts (hours):</label>
                            <input type="number" id="minBreakHours" class="form-control" step="0.25" min="0" value="10" placeholder="10">
                        </div>
                        <div>
                            <label for="maxWeeklyHours">Max Weekly Hours (before overtime):</label>
                            <input type="number" id="maxWeeklyHours" class="form-control" step="0.25" min="0" value="38" placeholder="38">
                        </div>
                        <div>
                            <label for="nightShiftStart">Night Shift Start Time:</label>
                            <input type="time" id="nightShiftStart" class="form-control" value="22:00">
                        </div>
                        <div>
                            <label for="nightShiftEnd">Night Shift End Time:</label>
                            <input type="time" id="nightShiftEnd" class="form-control" value="06:00">
                        </div>
                        <div>
                            <label for="afternoonShiftStart">Afternoon Shift Start Time:</label>
                            <input type="time" id="afternoonShiftStart" class="form-control" value="14:00">
                        </div>
                        <div>
                            <label for="afternoonShiftEnd">Afternoon Shift End Time:</label>
                            <input type="time" id="afternoonShiftEnd" class="form-control" value="22:00">
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label class="tooltip-label">Award Features:
                        <span class="tooltip-text">Enable specific features for this award such as sleepovers, meal allowances, first aid pay, and custom allowances. Check the boxes to activate and configure each feature.</span>
                    </label>
                    <div class="rate-grid">
                        <div>
                            <label for="hasSleepover">
                                <input type="checkbox" id="hasSleepover" onchange="toggleSleeperSection()"> Sleepovers Included
                            </label>
                        </div>
                        <div>
                            <label for="hasMealAllowances">
                                <input type="checkbox" id="hasMealAllowances" onchange="toggleMealAllowancesSection()"> Meal Allowances
                            </label>
                        </div>
                        <div>
                            <label for="hasFirstAid">
                                <input type="checkbox" id="hasFirstAid" onchange="toggleFirstAidSection()"> First Aid Allowance
                            </label>
                        </div>
                        <div>
                            <label for="hasCustomAllowances">
                                <input type="checkbox" id="hasCustomAllowances" onchange="toggleCustomAllowancesSection()"> Custom Allowances
                            </label>
                        </div>
                    </div>
                </div>

                <div id="sleeperSection" class="form-group" style="display: none;">
                    <label class="tooltip-label">Sleepover Settings:
                        <span class="tooltip-text">Configure fixed payment for sleepover shifts. This is a flat rate paid per sleepover shift regardless of hours worked.</span>
                    </label>
                    <div class="rate-grid">
                        <div>
                            <label for="sleeperRate">Sleepover Rate ($/shift):</label>
                            <input type="number" id="sleeperRate" class="form-control" step="0.01" min="0" value="0" placeholder="0.00">
                        </div>
                        <div>
                            <label for="minBreakHoursSleepover">Min Break Between Sleepovers (hours):</label>
                            <input type="number" id="minBreakHoursSleepover" class="form-control" step="0.25" min="0" value="8" placeholder="8">
                        </div>
                    </div>
                </div>

                <div id="mealAllowancesSection" class="form-group" style="display: none;">
                    <label class="tooltip-label">Meal Allowances:
                        <span class="tooltip-text">Set meal allowance payments that trigger after working a certain number of hours. Allowance 1 typically applies first, followed by Allowance 2 after additional hours.</span>
                    </label>
                    <div class="rate-grid">
                        <div>
                            <label for="mealAllowance1">Meal Allowance 1 ($/occurrence):</label>
                            <input type="number" id="mealAllowance1" class="form-control" step="0.01" min="0" value="0" placeholder="0.00">
                        </div>
                        <div>
                            <label for="mealAllowance1Hours">After how many hours:</label>
                            <input type="number" id="mealAllowance1Hours" class="form-control" step="0.25" min="0" value="5" placeholder="5">
                        </div>
                        <div>
                            <label for="mealAllowance2">Meal Allowance 2 ($/occurrence):</label>
                            <input type="number" id="mealAllowance2" class="form-control" step="0.01" min="0" value="0" placeholder="0.00">
                        </div>
                        <div>
                            <label for="mealAllowance2Hours">After how many hours:</label>
                            <input type="number" id="mealAllowance2Hours" class="form-control" step="0.25" min="0" value="10" placeholder="10">
                        </div>
                    </div>
                </div>

                <div id="firstAidSection" class="form-group" style="display: none;">
                    <label class="tooltip-label">First Aid Settings:
                        <span class="tooltip-text">Weekly allowance for employees who hold a valid first aid certificate. This amount is added to weekly pay.</span>
                    </label>
                    <div class="rate-grid">
                        <div>
                            <label for="firstAidAllowance">First Aid Allowance ($/week):</label>
                            <input type="number" id="firstAidAllowance" class="form-control" step="0.01" min="0" value="0" placeholder="0.00">
                        </div>
                    </div>
                </div>

                <div id="customAllowancesSection" class="form-group" style="display: none;">
                    <label class="tooltip-label">Custom Allowances:
                        <span class="tooltip-text">Add unlimited custom allowances specific to this award. Each custom allowance has a name and a fixed dollar amount.</span>
                    </label>
                    <div id="customAllowancesContainer"></div>
                    <button onclick="addCustomAllowanceField()" class="btn btn-secondary">Add Custom Allowance</button>
                </div>

                <button onclick="addAward()" class="btn btn-primary">Add Award</button>

                <div class="awards-list">
                    <h3>Existing Awards</h3>
                    <div id="awardsList"></div>
                </div>

                <div class="form-group">
                    <h3>Download Defaults Configuration</h3>
                    <p class="info-text">Download default configuration file containing awards, tax rates, and HELP debt thresholds (for use as default-*.json files).</p>
                    <button onclick="downloadDefaultsConfiguration()" class="btn btn-primary">Download Defaults Configuration (JSON)</button>
                </div>

                <div class="form-group">
                    <h3>Import/Export Configuration</h3>
                    <p class="info-text">Save and restore your complete configuration including awards, tax rates, HELP rates, calculator data, shifts, and settings.</p>
                    <button onclick="downloadConfiguration()" class="btn btn-primary">Download Complete Configuration (JSON)</button>
                    <button onclick="document.getElementById('uploadConfigInput').click()" class="btn btn-secondary">Upload Configuration (JSON)</button>
                    <input type="file" id="uploadConfigInput" accept=".json" style="display: none;" onchange="uploadConfiguration(event)">
                </div>
                
                <div class="form-group">
                    <h3>Import/Export Awards Only</h3>
                    <p class="info-text">Export or import only the awards (legacy format).</p>
                    <button onclick="downloadAwards()" class="btn btn-primary">Download Awards (JSON)</button>
                    <button onclick="document.getElementById('uploadAwardsInput').click()" class="btn btn-secondary">Upload Awards (JSON)</button>
                    <input type="file" id="uploadAwardsInput" accept=".json" style="display: none;" onchange="uploadAwards(event)">
                </div>
            </div>

            <div class="card">
                <h2 style="display: flex; justify-content: space-between; align-items: center;">
                    <span>Tax Rate Configuration</span>
                    <button onclick="clearLocalStorage('tax')" class="btn btn-danger" style="font-size: 0.8em; padding: 8px 15px;">Clear Tax Data</button>
                </h2>
                <p class="info-text">Configure Australian tax brackets (2024-2025 financial year defaults)</p>
                
                <div class="form-group">
                    <label for="taxYear">Financial Year:</label>
                    <select id="taxYear" class="form-control" onchange="switchTaxYear(this.value)">
                    </select>
                    <button onclick="addNewTaxYear()" class="btn btn-secondary" style="margin-top: 10px;">Add New Year</button>
                </div>
                
                <div id="taxBrackets"></div>
                
                <button onclick="addTaxBracket()" class="btn btn-secondary">Add Tax Bracket</button>
                <button onclick="saveTaxRates()" class="btn btn-primary">Save Tax Rates</button>
            </div>

            <div class="card">
                <h2 style="display: flex; justify-content: space-between; align-items: center;">
                    <span>HELP Debt Configuration</span>
                    <button onclick="clearLocalStorage('help')" class="btn btn-danger" style="font-size: 0.8em; padding: 8px 15px;">Clear HELP Data</button>
                </h2>
                <p class="info-text">Configure HELP debt repayment thresholds (2024-2025 financial year defaults)</p>
                
                <div class="form-group">
                    <label for="helpYear">Financial Year:</label>
                    <select id="helpYear" class="form-control" onchange="switchHelpYear(this.value)">
                    </select>
                    <button onclick="addNewHelpYear()" class="btn btn-secondary" style="margin-top: 10px;">Add New Year</button>
                </div>
                
                <div id="helpThresholds"></div>
                
                <button onclick="addHelpThreshold()" class="btn btn-secondary">Add HELP Threshold</button>
                <button onclick="saveHelpRates()" class="btn btn-primary">Save HELP Rates</button>
            </div>
        </div>

        <footer>
            <p>Payslip Checker - Australian Tax and HELP Debt Calculator</p>
            <p class="disclaimer">This calculator provides estimates only. Please consult with a tax professional for accurate calculations.</p>
        </footer>
    </div>

    <script src="script.js"></script>
</body>
</html>
